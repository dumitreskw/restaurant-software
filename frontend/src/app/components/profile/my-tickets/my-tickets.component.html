<p-fieldset [legend]="'Tickets'"> 
    <div class="mb-3">
        <p-button 
            type="button" 
            icon="pi pi-chevron-left" 
            (click)="prev()" 
            [disabled]="isFirstPage()" 
            styleClass="p-button-text" />
        <p-button 
            type="button"
            icon="pi pi-refresh" 
            (click)="reset()" 
            styleClass="p-button-text" />
        <p-button 
            type="button" 
            icon="pi pi-chevron-right" 
            (click)="next()" 
            [disabled]="isLastPage()" 
            styleClass="p-button-text" />
    </div>

    <div class="card">
        <p-table
            [value]="tickets"
            [paginator]="true"
            [rows]="10"
            [first]="first"
            [showCurrentPageReport]="true"
            [tableStyle]="{ 'min-width': '50rem' }"
            [loading]="isLoading"
            currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
            (onPage)="pageChange($event)"
            [rowsPerPageOptions]="[10, 25, 50]"
        >
            <ng-template pTemplate="header">
                <tr>
                    <th style="width:20%">Id</th>
                    <th style="width:20%">Title</th>
                    <th style="width:20%">Date</th>
                    <th style="width:20%">Status</th>
                    <th style="width:20%">Actions</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-ticket>
                <tr>
                    <td>{{ ticket._id }}</td>
                    <td>{{ ticket.title }}</td>
                    <td>{{ ticket.createdAt }}</td>
                    <td>
                        <p-tag [severity]="getStatusSeverity(ticket.status)" [value]="ticket.status"/>
                    </td>
                    <td>
                        <div class="actions">
                            <p-button icon="pi pi-eye" [rounded]="true" [text]="true" severity="secondary" (onClick)="onViewTicket(ticket._id)"/>
                            <p-button icon="pi pi-times" [rounded]="true" [text]="true" severity="danger" *ngIf="ticket.status == 'pending'" alt="cancel" (onClick)="onCompleteTicket(ticket._id)"/>
                        </div>
                    </td>
                </tr>
            </ng-template>
            <ng-template pTemplate="paginatorleft">
                <p-button type="button" icon="pi pi-plus" styleClass="p-button-text" (onClick)="onAddTicket()"/>
            </ng-template>
            <ng-template pTemplate="paginatorright">
                <p-button type="button" icon="" styleClass="p-button-text" />
            </ng-template>
        </p-table>
    </div>
</p-fieldset>
