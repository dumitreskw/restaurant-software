<div class="wrapper">
    <h1 mat-dialog-title>Ticket {{ticket._id}}</h1>
    <div mat-dialog-content>
        <div class="content">
            <div class="ticket-header">
                <div class="dates">
                    <div class="created-at">Ticket created on {{ticket.createdAt}}</div>
                    <div class="last-updated">Last update on {{ticket.updatedAt}}</div>
                </div>
                <div class="status">Status: 
                    <p-tag [severity]="ticket.status == 'pending' ? 'secondary': 'success'" [value]="ticket.status"/>
                </div>
            </div>
            <div class="messages">
                @for (message of ticket.messages; track null) {
                    @if(message.user == ticket.owner) {
                        <div class="right-message">
                            <p>User: </p>
                            <p>{{message.text}}</p>
                        </div>
                    }
                    @else {
                        <div class="left-message">
                            <p>Admin: </p>
                            <p>{{message.text}}</p>
                        </div>
                    }
                }
            </div>
            <div class="add-message-content">
                <div class="text-area">
                    <form [formGroup]="formGroup">
                        <textarea 
                            rows="2" 
                            cols="100" 
                            pInputTextarea 
                            formControlName="comment">
                        </textarea>
                    </form>
                </div>
                <div class="action">
                    <p-button label="Add Comment" (onClick)="onAddComment()" [disabled]="!commentControl.valid || ticket.status != 'pending'"/>
                </div>
            </div>
        </div>
    </div>
    <div mat-dialog-actions>
      <button mat-button mat-dialog-close color="secondary">Close</button>
    </div>
  </div>